<!DOCTYPE html><html lang="en"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Document</title><link rel="stylesheet" href="/_astro/descargar.CPStXUp1.css"><script type="module">const u=document.querySelector("#myForm"),o=document.getElementById("btnSend");u?.addEventListener("submit",n=>{n.preventDefault(),o.textContent="descargando...";const r=n.currentTarget,a=r.elements.namedItem("name")?.value,s=r.elements.namedItem("password")?.value,d={name:a,password:s};console.log(a,s);async function l(){try{const e=await fetch("http://localhost/downloadexcel/download.php",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(d)});if(!e.ok){o.textContent="Incorrecto";const i=await e.json();throw new Error(`Error: ${i.error}`)}o.textContent="Descargado";const m=await e.blob(),c=window.URL.createObjectURL(m),t=document.createElement("a");t.style.display="none",t.href=c,t.download="datos.xlsx",document.body.appendChild(t),t.click(),window.URL.revokeObjectURL(c)}catch(e){o.textContent="Ocurrio un error",console.error("Error al obtener los datos:",e)}finally{setTimeout(()=>{o.textContent="descargar"},2e3)}}l()});
</script></head> <body class="w-full h-screen flex flex-col justify-center items-center"> <figure> <img src="gigamas_logo.png" alt=""> </figure> <form id="myForm" class="p-4 flex flex-col gap-8"> <input type="text" name="name" placeholder="Name" required class="h-12 w-64 outline-none border-2  px-4 rounded-md"> <input type="password" name="password" placeholder="Password" required class="h-12 w-64 outline-none border-2  px-4 rounded-md"> <button id="btnSend" type="submit" class="h-12 w-64 bg-secondary rounded-md text-white hover:scale-105 transition-all duration-100">Descargar</button> </form>  </body> </html> 